"use strict";(self.webpackChunkcraftelligence_website=self.webpackChunkcraftelligence_website||[]).push([[382],{2382:(e,l,a)=>{a.r(l),a.d(l,{default:()=>b});var o=a(3986),r=a(2555),t=a(9950),n=a(728),i=a(8518),s=a(133),u=a(3096),c=a(4414);const d=["resume"],p="http://localhost:8000".replace(/\/$/,""),v=e=>"".concat(p).concat(e.startsWith("/")?e:"/".concat(e)),m={name:"",email:"",phone:"",resume:null,availability:"",location:"",start_date:"",current_job_location:"",job_status:"",experience_years:"",current_position:"",user_role:"",preferred_salary:"",looking_for:""},_={name:"Full Name",email:"Email",phone:"Phone Number",availability:"Availability",location:"Interested Location",start_date:"Start Date",current_job_location:"Current Job Location",job_status:"Job Status",experience_years:"Experience (years)",current_position:"Current Position",resume:"Resume (PDF)",user_role:"User Role",preferred_salary:"Preferred Salary (LPA)",looking_for:"Looking For"};function b(){const[e,l]=(0,t.useState)(()=>s.j2.currentUser),a=(0,i.Zp)(),[p,b]=(0,t.useState)(m),[y,j]=(0,t.useState)(!1),[g,x]=(0,t.useState)(""),[k,w]=(0,t.useState)(""),[C,S]=(0,t.useState)(!1);(0,t.useEffect)(()=>{const e=(0,u.hg)(s.j2,e=>l(e));return()=>e()},[]),(0,t.useEffect)(()=>{e&&b(l=>(0,r.A)((0,r.A)({},l),{},{name:l.name||e.displayName||"",email:l.email||e.email||""}))},[e]);const A=e=>"profile:".concat(e);(0,t.useEffect)(()=>{if(e)try{const l=localStorage.getItem(A(e.uid));if(l){const e=JSON.parse(l);b(l=>(0,r.A)((0,r.A)((0,r.A)({},l),e),{},{resume:null}))}}catch(l){}},[e]),(0,t.useEffect)(()=>{if(e)try{const{resume:l}=p,a=(0,o.A)(p,d);localStorage.setItem(A(e.uid),JSON.stringify(a))}catch(l){}},[e,p]),(0,t.useEffect)(()=>{(async()=>{if(e)try{var l;j(!0);const a=await(null===(l=e.getIdToken)||void 0===l?void 0:l.call(e)),o=a?{Authorization:"Bearer ".concat(a)}:{},t=await fetch(v("/profiles/user/".concat(encodeURIComponent(e.uid))),{method:"GET",headers:(0,r.A)({},o)});if(404===t.status)return;if(!t.ok)return;const n=await t.json();b(e=>{var l,a,o,t,i,s,u,c,d,p,v,m,_,b,h,f,y,j,g,x,k,w;return(0,r.A)((0,r.A)({},e),{},{name:null!==(l=null!==(a=n.name)&&void 0!==a?a:e.name)&&void 0!==l?l:"",email:null!==(o=null!==(t=n.email)&&void 0!==t?t:e.email)&&void 0!==o?o:"",phone:null!==(i=null!==(s=n.phone_no)&&void 0!==s?s:e.phone)&&void 0!==i?i:"",availability:null!==(u=null!==(c=n.availability)&&void 0!==c?c:e.availability)&&void 0!==u?u:"",location:null!==(d=null!==(p=n.interested_location)&&void 0!==p?p:e.location)&&void 0!==d?d:"",start_date:null!==(v=null!==(m=n.start_date)&&void 0!==m?m:e.start_date)&&void 0!==v?v:"",current_job_location:null!==(_=null!==(b=n.current_job_location)&&void 0!==b?b:e.current_job_location)&&void 0!==_?_:"",job_status:null!==(h=null!==(f=n.job_status)&&void 0!==f?f:e.job_status)&&void 0!==h?h:"",experience_years:void 0!==n.experience_years&&null!==n.experience_years?String(n.experience_years):e.experience_years,current_position:null!==(y=null!==(j=n.current_position)&&void 0!==j?j:e.current_position)&&void 0!==y?y:"",preferred_salary:void 0!==n.preferred_salary&&null!==n.preferred_salary?String(n.preferred_salary):e.preferred_salary,looking_for:null!==(g=null!==(x=n.looking_for)&&void 0!==x?x:e.looking_for)&&void 0!==g?g:"",user_role:null!==(k=null!==(w=n.user_role)&&void 0!==w?w:e.user_role)&&void 0!==k?k:"",resume:null})})}catch(a){}finally{j(!1)}})()},[e]);const N=(0,t.useMemo)(()=>{const{name:e,email:l,phone:a,availability:o,location:r,start_date:t,current_job_location:n,job_status:i,current_position:s,resume:u}=p;return!!e&&!!l&&!!a&&!!o&&!!r&&!!t&&!!n&&!!i&&""!==p.experience_years&&!!s&&u instanceof File},[p]),E=e=>{const{name:l,value:a,files:o}=e.target;if("resume"===l){const e=o&&o[0];b(l=>(0,r.A)((0,r.A)({},l),{},{resume:e||null}))}else b(e=>(0,r.A)((0,r.A)({},e),{},{[l]:a}))},P=e=>{const l=new FormData,a={name:e.name,email:e.email,phone_no:e.phone,availability:e.availability,interested_location:e.location,start_date:e.start_date,current_job_location:e.current_job_location,job_status:e.job_status,experience_years:e.experience_years,current_position:e.current_position,preferred_salary:e.preferred_salary,looking_for:e.looking_for,user_role:e.user_role,resume:e.resume};return Object.entries(a).forEach(e=>{let[a,o]=e;void 0!==o&&null!==o&&""!==o&&l.append(a,o)}),l};return(0,c.jsx)("div",{className:"profile-page",children:(0,c.jsxs)("div",{className:"profile-container",children:[(0,c.jsx)("div",{className:"profile-topbar",children:(0,c.jsx)("button",{type:"button",className:"back-btn",onClick:()=>a("/onboarding"),children:"\u2190 Back to Home"})}),(0,c.jsxs)(n.P.div,{className:"profile-card",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,c.jsxs)("div",{className:"profile-header",children:[(0,c.jsx)("h2",{children:"Your Profile"}),(0,c.jsx)("p",{children:"Keep your information up to date. Simple and clean."})]}),g&&(0,c.jsx)("div",{className:"message-success",children:g}),k&&(0,c.jsx)("div",{className:"message-error",children:k}),(0,c.jsxs)("form",{onSubmit:async l=>{if(l.preventDefault(),e){j(!0),x(""),w("");try{var a;const l=(0,r.A)({},p),s=P(l),u=await(null===(a=e.getIdToken)||void 0===a?void 0:a.call(e)),c=u?{Authorization:"Bearer ".concat(u)}:{},d=await fetch(v("/profiles/user/".concat(encodeURIComponent(e.uid))),{method:"PUT",headers:c,body:s});if(d.ok){try{var o;const l=await(null===(o=e.getIdToken)||void 0===o?void 0:o.call(e)),a=l?{Authorization:"Bearer ".concat(l)}:{},t=await fetch(v("/profiles/user/".concat(encodeURIComponent(e.uid))),{method:"GET",headers:(0,r.A)((0,r.A)({},a),{},{"Cache-Control":"no-store"})});if(t.ok){const e=await t.json();b(l=>{var a,o,t,n,i,s,u,c,d,p,v,m,_,b,h,f,y,j,g,x,k,w;return(0,r.A)((0,r.A)({},l),{},{name:null!==(a=null!==(o=e.name)&&void 0!==o?o:l.name)&&void 0!==a?a:"",email:null!==(t=null!==(n=e.email)&&void 0!==n?n:l.email)&&void 0!==t?t:"",phone:null!==(i=null!==(s=e.phone_no)&&void 0!==s?s:l.phone)&&void 0!==i?i:"",availability:null!==(u=null!==(c=e.availability)&&void 0!==c?c:l.availability)&&void 0!==u?u:"",location:null!==(d=null!==(p=e.interested_location)&&void 0!==p?p:l.location)&&void 0!==d?d:"",start_date:null!==(v=null!==(m=e.start_date)&&void 0!==m?m:l.start_date)&&void 0!==v?v:"",current_job_location:null!==(_=null!==(b=e.current_job_location)&&void 0!==b?b:l.current_job_location)&&void 0!==_?_:"",job_status:null!==(h=null!==(f=e.job_status)&&void 0!==f?f:l.job_status)&&void 0!==h?h:"",experience_years:void 0!==e.experience_years&&null!==e.experience_years?String(e.experience_years):l.experience_years,current_position:null!==(y=null!==(j=e.current_position)&&void 0!==j?j:l.current_position)&&void 0!==y?y:"",preferred_salary:void 0!==e.preferred_salary&&null!==e.preferred_salary?String(e.preferred_salary):l.preferred_salary,looking_for:null!==(g=null!==(x=e.looking_for)&&void 0!==x?x:l.looking_for)&&void 0!==g?g:"",user_role:null!==(k=null!==(w=e.user_role)&&void 0!==w?w:l.user_role)&&void 0!==k?k:"",resume:null})})}}catch(n){}return void x("Profile updated successfully.")}if(404===d.status){if(!N)throw new Error("Please complete all required fields and attach a PDF resume to create your profile.");const l=P(p),a=await fetch(v("/profiles/"),{method:"POST",headers:c,body:l});if(!a.ok){const e=await a.text();throw new Error(e||"Failed to create profile")}try{var t;const l=await(null===(t=e.getIdToken)||void 0===t?void 0:t.call(e)),a=l?{Authorization:"Bearer ".concat(l)}:{},o=await fetch(v("/profiles/user/".concat(encodeURIComponent(e.uid))),{method:"GET",headers:(0,r.A)((0,r.A)({},a),{},{"Cache-Control":"no-store"})});if(o.ok){const e=await o.json();b(l=>{var a,o,t,n,i,s,u,c,d,p,v,m,_,b,h,f,y,j,g,x,k,w;return(0,r.A)((0,r.A)({},l),{},{name:null!==(a=null!==(o=e.name)&&void 0!==o?o:l.name)&&void 0!==a?a:"",email:null!==(t=null!==(n=e.email)&&void 0!==n?n:l.email)&&void 0!==t?t:"",phone:null!==(i=null!==(s=e.phone_no)&&void 0!==s?s:l.phone)&&void 0!==i?i:"",availability:null!==(u=null!==(c=e.availability)&&void 0!==c?c:l.availability)&&void 0!==u?u:"",location:null!==(d=null!==(p=e.interested_location)&&void 0!==p?p:l.location)&&void 0!==d?d:"",start_date:null!==(v=null!==(m=e.start_date)&&void 0!==m?m:l.start_date)&&void 0!==v?v:"",current_job_location:null!==(_=null!==(b=e.current_job_location)&&void 0!==b?b:l.current_job_location)&&void 0!==_?_:"",job_status:null!==(h=null!==(f=e.job_status)&&void 0!==f?f:l.job_status)&&void 0!==h?h:"",experience_years:void 0!==e.experience_years&&null!==e.experience_years?String(e.experience_years):l.experience_years,current_position:null!==(y=null!==(j=e.current_position)&&void 0!==j?j:l.current_position)&&void 0!==y?y:"",preferred_salary:void 0!==e.preferred_salary&&null!==e.preferred_salary?String(e.preferred_salary):l.preferred_salary,looking_for:null!==(g=null!==(x=e.looking_for)&&void 0!==x?x:l.looking_for)&&void 0!==g?g:"",user_role:null!==(k=null!==(w=e.user_role)&&void 0!==w?w:l.user_role)&&void 0!==k?k:"",resume:null})})}}catch(i){}return void x("Profile created successfully.")}const m=await d.text();throw new Error(m||"Failed to update profile")}catch(s){w(s.message||"Something went wrong")}finally{j(!1)}}else w("You must be logged in to update your profile.")},children:[(0,c.jsxs)("div",{className:"form-grid",children:[(0,c.jsx)(h,{label:_.name,name:"name",value:p.name,onChange:E,required:!0,placeholder:"Enter your full name"}),(0,c.jsx)(h,{type:"email",label:_.email,name:"email",value:p.email,onChange:E,required:!0,placeholder:"Enter your email"}),(0,c.jsx)(h,{label:_.phone,name:"phone",value:p.phone,onChange:E,required:!0,placeholder:"Enter your phone number"}),(0,c.jsx)(f,{label:_.availability,name:"availability",value:p.availability,onChange:E,options:[{value:"",label:"Select availability"},{value:"full-time",label:"Full Time (40hrs/week)"},{value:"part-time",label:"Part Time (20hrs/week)"}],required:!0}),(0,c.jsx)(f,{label:_.location,name:"location",value:p.location,onChange:E,options:[{value:"",label:"Select location preference"},{value:"remote",label:"Remote"},{value:"onsite",label:"Onsite"},{value:"both",label:"Both Remote & Onsite"}],required:!0}),(0,c.jsx)(f,{label:_.start_date,name:"start_date",value:p.start_date,onChange:E,options:[{value:"",label:"Select start date"},{value:"immediately",label:"Immediately"},{value:"15 days",label:"15 days"},{value:"1 month",label:"1 month"}],required:!0}),(0,c.jsx)(h,{label:_.current_job_location,name:"current_job_location",value:p.current_job_location,onChange:E,required:!0,placeholder:"Enter your current job location"}),(0,c.jsx)(f,{label:_.job_status,name:"job_status",value:p.job_status,onChange:E,options:[{value:"",label:"Select job status"},{value:"employed",label:"Employed"},{value:"unemployed",label:"Unemployed"},{value:"open-to-offers",label:"Open to Offers"}],required:!0}),(0,c.jsx)(h,{type:"number",min:"0",step:"0.1",label:_.experience_years,name:"experience_years",value:p.experience_years,onChange:E,required:!0,placeholder:"Years of experience"}),(0,c.jsx)(f,{label:_.current_position,name:"current_position",value:p.current_position,onChange:E,options:[{value:"",label:"Select current position"},{value:"frontend",label:"Frontend Developer"},{value:"backend",label:"Backend Developer"},{value:"full stack",label:"Full Stack Developer"},{value:"data scientist",label:"Data Scientist"},{value:"ai-ml",label:"AI/ML Engineer"},{value:"qa",label:"QA Engineer"},{value:"other",label:"Other"}],required:!0}),(0,c.jsx)(h,{type:"text",label:_.preferred_salary,name:"preferred_salary",value:p.preferred_salary,onChange:E,placeholder:"Enter expected salary (e.g., 15 LPA)"}),(0,c.jsx)(f,{label:_.looking_for,name:"looking_for",value:p.looking_for,onChange:E,options:[{value:"",label:"Select job role"},{value:"frontend",label:"Frontend Developer"},{value:"backend",label:"Backend Developer"},{value:"full stack",label:"Full Stack Developer"},{value:"data scientist",label:"Data Scientist"},{value:"ai-ml",label:"AI/ML Engineer"},{value:"qa",label:"QA Engineer"},{value:"other",label:"Other"}]}),(0,c.jsx)(f,{label:_.user_role,name:"user_role",value:p.user_role,onChange:E,options:[{value:"",label:"Select employment type"},{value:"contractor",label:"Contractor"},{value:"full-time",label:"Full-time"},{value:"part-time",label:"Part-time"},{value:"any",label:"Any"}]}),(0,c.jsxs)("div",{className:"file-row",children:[(0,c.jsx)("label",{children:_.resume}),(0,c.jsxs)("div",{className:"file-input-wrapper",children:[(0,c.jsx)("input",{type:"file",name:"resume",accept:"application/pdf",onChange:E,className:"file-input"}),(0,c.jsx)("span",{className:"file-label",children:p.resume?"string"===typeof p.resume?p.resume.split("/").pop():p.resume.name:"Choose PDF file"})]}),(0,c.jsx)("small",{className:"file-hint",children:"Upload a PDF file. Max 5MB."})]})]}),(0,c.jsxs)("div",{className:"btn-row",children:[(0,c.jsx)("button",{type:"button",onClick:()=>{e?S(!0):w("You must be logged in to delete your profile.")},disabled:y,className:"btn btn-danger",children:y?"Please wait...":"Delete Profile"}),(0,c.jsx)("button",{type:"submit",disabled:y,className:"submit-btn",style:{minWidth:140},children:y?"Saving...":"Save"})]})]})]}),C&&(0,c.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",children:(0,c.jsxs)(n.P.div,{className:"modal-card",initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},transition:{duration:.2},children:[(0,c.jsx)("h3",{children:"Delete Profile"}),(0,c.jsx)("p",{children:"This action will permanently remove your profile and sign you out. This cannot be undone."}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"btn",onClick:()=>S(!1),disabled:y,children:"Cancel"}),(0,c.jsx)("button",{className:"btn btn-danger",onClick:async()=>{await(async()=>{if(e){j(!0),x(""),w("");try{var l;const t=await(null===(l=e.getIdToken)||void 0===l?void 0:l.call(e)),n=t?{Authorization:"Bearer ".concat(t)}:{},i=await fetch(v("/profiles/user/".concat(encodeURIComponent(e.uid))),{method:"DELETE",headers:n});if(!i.ok){const e=await i.text();throw new Error(e||"Failed to delete profile")}try{await(0,u.hG)(e);try{localStorage.removeItem("profile:".concat(e.uid))}catch(o){}return await(0,u.CI)(s.j2).catch(()=>{}),void a("/")}catch(r){return await(0,u.CI)(s.j2).catch(()=>{}),void a("/")}}catch(t){w(t.message||"Something went wrong while deleting")}finally{j(!1)}}else w("You must be logged in to delete your profile.")})(),S(!1)},disabled:y,children:y?"Deleting...":"Delete"})]})]})})]})})}function h(e){let{label:l,name:a,value:o,onChange:r,type:t="text",required:n,min:i,step:s}=e;return(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{children:[l,n?" *":""]}),(0,c.jsx)("input",{className:"input",type:t,name:a,value:o,onChange:r,required:n,min:i,step:s})]})}function f(e){let{label:l,name:a,value:o,onChange:r,options:t,required:n}=e;return(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{children:[l,n?" *":""]}),(0,c.jsx)("select",{name:a,value:o,onChange:r,required:n,className:"select",children:t.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))})]})}}}]);